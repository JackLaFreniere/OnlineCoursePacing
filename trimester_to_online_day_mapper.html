<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Trimester to Online Course Day Mapper</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f7f7f7; margin: 40px; }
        .container { background: #fff; padding: 30px; border-radius: 8px; max-width: 600px; margin: auto; box-shadow: 0 2px 8px #ccc; }
        h1 { text-align: center; }
        form { margin-bottom: 30px; }
        label { display: block; margin-top: 15px; }
        input[type="date"] { width: 100%; padding: 8px; margin-top: 5px; }
        button { margin-top: 20px; padding: 10px 20px; background: #0078d7; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #005fa3; }
        .info { margin-top: 20px; background: #e7f3ff; padding: 10px; border-radius: 4px; }
        .result { font-size: 1.2em; color: #0078d7; margin-top: 10px; }
    </style>
</head>
<body>
<div class="container">
    <h1>Trimester to Online Course Day Mapper</h1>
    <form id="dateForm">
        <label>Trimester Start Date:
            <select id="trimester_start" required>
                <option value="2025-09-02">1st Trimester (09-02-25)</option>
                <option value="2025-12-02">2nd Trimester (12-02-25)</option>
                <option value="2026-03-10">3rd Trimester (03-10-26)</option>
            </select>
        </label>
        <label>Online Course Start Date:
            <input type="date" id="course_start" required>
        </label>
        <label>Select a Real Life Trimester Date:
            <input type="date" id="target_date" required>
        </label>
        <button type="submit">Find Corresponding Online Course Day</button>
    </form>
    <div class="info" id="output" style="display:none;"></div>
</div>
<script>
// Set default value of target_date to today
window.onload = function() {
    var today = new Date();
    var yyyy = today.getFullYear();
    var mm = String(today.getMonth() + 1).padStart(2, '0');
    var dd = String(today.getDate()).padStart(2, '0');
    var todayStr = yyyy + '-' + mm + '-' + dd;
    document.getElementById('target_date').value = todayStr;
};
function parseDate(str) {
    // Parse as UTC to avoid timezone issues
    var [y, m, d] = str.split('-').map(Number);
    var date = new Date(Date.UTC(y, m - 1, d));
    date.setUTCHours(0,0,0,0);
    return date;
}
function formatDate(date) {
    // Format as YYYY-MM-DD in UTC
    return date.toISOString().slice(0, 10);
}
function getWeekdaysBetween(start, end) {
    let days = [];
    let current = new Date(start.getTime());
    while (current <= end) {
        let day = current.getUTCDay(); // 0=Sun, 1=Mon, ..., 6=Sat
        if (day >= 1 && day <= 5) { // Mon-Fri
            days.push(new Date(current.getTime()));
        }
        current.setUTCDate(current.getUTCDate() + 1);
    }
    return days;
}
document.getElementById('dateForm').onsubmit = function(e) {
    e.preventDefault();
    let trimester_start = parseDate(document.getElementById('trimester_start').value);
    let course_start = parseDate(document.getElementById('course_start').value);
    let target_date = parseDate(document.getElementById('target_date').value);
    // Hard code durations
    let trimester_weeks = 12;
    let course_weeks = 20;
    let trimester_end = new Date(trimester_start.getTime());
    trimester_end.setUTCDate(trimester_end.getUTCDate() + (trimester_weeks * 7) - 1);
    let course_end = new Date(course_start.getTime());
    course_end.setUTCDate(course_end.getUTCDate() + (course_weeks * 7) - 1);
    if (trimester_end < trimester_start || course_end < course_start || target_date < trimester_start || target_date > trimester_end) {
        document.getElementById('output').style.display = 'block';
        document.getElementById('output').innerHTML = '<span style="color:red;">Please check your date ranges.</span>';
        return;
    }
    // Calculate days into trimester (including weekends)
    let daysIntoTrimester = Math.floor((target_date.getTime() - trimester_start.getTime()) / (1000*60*60*24));
    let totalTrimesterDays = Math.floor((trimester_end.getTime() - trimester_start.getTime()) / (1000*60*60*24)) + 1;
    // Get all online course weekdays
    let courseWeekdays = getWeekdaysBetween(course_start, course_end);
    // Map real day index to online course weekday index
    let courseIndex = Math.round(daysIntoTrimester * (courseWeekdays.length / totalTrimesterDays));
    if (courseIndex < 0) courseIndex = 0;
    if (courseIndex >= courseWeekdays.length) courseIndex = courseWeekdays.length - 1;
    let courseDate = courseWeekdays[courseIndex];
    let info = `<strong>Trimester End Date:</strong> ${formatDate(trimester_end)}<br><strong>Online Course End Date:</strong> ${formatDate(course_end)}<br><br><strong>On your trimester date, you should be at:</strong><br><span class='result'>${formatDate(courseDate)}</span> in your online course.`;
    document.getElementById('output').style.display = 'block';
    document.getElementById('output').innerHTML = info;
};
</script>
</body>
</html>
